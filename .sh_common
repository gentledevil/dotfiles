#!/bin/sh

### Options ###
set -o emacs

# umask, different if root
[ "$(id -u)" != 0 ] && umask 027 || umask 022

### Environment ###

# mail
export EMAIL="jonathan.lestrelin@gmail.com"
export MAILPATH=/var/spool/mail/$USER:$HOME/Mail
export DEBFULLNAME="Jonathan Lestrelin"
export DEBEMAIL="$EMAIL"

export EDITOR=vim
export PAGER=less
export SYSTEMD_PAGER=cat
export GIT_PAGER=cat
export BROWSER=firefox

# less
export LESS=-wR

# make less more friendly for non-text input files, see lesspipe(1)
which lesspipe >/dev/null 2>&1 && eval "$(SHELL=/bin/sh lesspipe)"
which lesspipe.sh >/dev/null 2>&1 && eval "$(SHELL=/bin/sh lesspipe.sh)"

### Aliases ###

alias l="ls"
alias l.="ls -d .*"
alias ll="ls -lh"
alias la="ls -lhA"
alias lx="ls -lhAxb"          # sort by extension
alias lk="ls -lhASr"          # sort by size, biggest last
alias lt="ls -lhAtr"          # sort by date, most recent last
alias lsb="ls -ail"
alias sl="ls"
alias cta="cat"
alias rm="rm -i"
alias cp="cp -i"
alias mv="mv -i"
alias g='egrep -i'
alias open="xdg-open"
alias trash="gvfs-trash"
alias em="emacs -nw"
alias vi="vim"
alias e="\$EDITOR"

### Functions ###

cl() {
	cd "$1" && ls
}

md() {
	mkdir -p "$1" && cd "$1"
}

h() {
	test -z "$1" && history || history | egrep -i "$1"
}

### Color ###

if [ ! -z "$COLORTERM" ]
then
	# 256 colors in terminal
	TERM=xterm-256color
fi
export CLICOLOR=true
if which dircolors >/dev/null 2>&1; then
	eval "$(dircolors ~/.dircolors)"
fi
if ls --version 2>/dev/null | grep -q GNU; then
	alias ls="ls --color=auto --group-directories-first"
fi
if which colordiff >/dev/null 2>&1; then
	alias diff=colordiff
fi
if [ -f "/usr/lib/libstderred.so" ]; then
	export LD_PRELOAD="/usr/lib/libstderred.so"
fi
if [ "$(uname)" = "Linux" ]; then
	alias dmesg="dmesg -TL"
fi
if grep -V 2>/dev/null | grep -q GNU; then
	alias grep="grep --color=auto"
	alias egrep="egrep --color=auto"
	alias fgrep="fgrep --color=auto"
fi
alias tree="tree -C"

export LESS_TERMCAP_mb=$'\E[01;31m'       # begin blinking
export LESS_TERMCAP_me=$'\E[0m'           # end mode
export LESS_TERMCAP_se=$'\E[0m'           # end standout-mode
export LESS_TERMCAP_ue=$'\E[0m'           # end underline

# blue
#export LESS_TERMCAP_md=$'\E[01;38;5;33m'  # begin bold
#export LESS_TERMCAP_so=$'\E[01;31;5;31m'  # begin standout-mode - info box
#export LESS_TERMCAP_us=$'\E[38;5;31m'     # begin underline

# red and blue
export LESS_TERMCAP_md=$'\E[01;31m'       # begin bold
export LESS_TERMCAP_so=$'\E[01;47;31m'    # begin standout-mode - info box                              
export LESS_TERMCAP_us=$'\E[04;38;05;32m' # begin underline

### Source host specific definitions ###
if [ -f ~/.sh_local ]; then
	. ~/.sh_local
fi

